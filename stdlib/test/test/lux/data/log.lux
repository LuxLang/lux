##  Copyright (c) Eduardo Julian. All rights reserved.
##  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
##  If a copy of the MPL was not distributed with this file,
##  You can obtain one at http://mozilla.org/MPL/2.0/.

(;module:
  lux
  (lux (codata [io])
       (control monad)
       (data log
             [text "Text/" Monoid<Text>]
             [number])
       (codata function))
  lux/test)

(test: "lux/data/log exports"
  (all (match ["" 11]
              (:: Functor<Log> map inc ["" 10]))
       (match ["" 20]
              (:: (Applicative<Log> text;Monoid<Text>) wrap 20))
       (match ["" 30]
              (let [(^open) (Applicative<Log> text;Monoid<Text>)]
                (apply (wrap (+ 10)) (wrap 20))))
       (match ["" 30]
              (do (Monad<Log> text;Monoid<Text>)
                [f (wrap +)
                 a (wrap 10)
                 b (wrap 20)]
                (wrap (f a b))))
       (match ["YOLO" []]
              (log "YOLO"))
       ))
