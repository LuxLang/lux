(.module:
  [lux #*
   [control
    [equivalence (#+ Equivalence)]
    [hash (#+ Hash)]]
   [data
    ["." text]]
   [type
    abstract]
   [macro
    ["." template]]])

## https://en.wikipedia.org/wiki/List_of_ISO_639-2_codes
(abstract: #export Language
  {}

  Text

  (def: #export language
    (-> Language Text)
    (|>> :representation))

  (do-template [<code> <name> <alias>+]
    [(def: #export <name> Language (:abstraction <code>))
     (`` (do-template [<alias>]
           [(def: #export <alias> Language <name>)]

           (~~ (template.splice <alias>+))))]

    ["mis" uncoded []]
    ["mul" multiple []]
    ["und" undetermined []]
    ["zxx" not-applicable []]

    ["aar" afar []]
    ["abk" abkhazian []]
    ["ace" achinese []]
    ["ach" acoli []]
    ["ada" adangme []]
    ["ady" adyghe []]
    ["afa" afro-asiatic []]
    ["afh" afrihili []]
    ["afr" afrikaans []]
    ["ain" ainu []]
    ["aka" akan []]
    ["akk" akkadian []]
    ["ale" aleut []]
    ["alg" algonquian []]
    ["alt" southern-altai []]
    ["amh" amharic []]
    ["ang" old-english []]
    ["anp" angika []]
    ["apa" apache []]
    ["ara" arabic []]
    ["arc" official-aramaic []]
    ["arg" aragonese []]
    ["arn" mapudungun []]
    ["arp" arapaho []]
    ["art" artificial []]
    ["arw" arawak []]
    ["asm" assamese []]
    ["ast" asturian [[bable] [leonese] [asturleonese]]]
    ["ath" athapascan []]
    ["aus" australian []]
    ["ava" avaric []]
    ["ave" avestan []]
    ["awa" awadhi []]
    ["aym" aymara []]
    ["aze" azerbaijani []]
    ["bad" banda []]
    ["bai" bamileke []]
    ["bak" bashkir []]
    ["bal" baluchi []]
    ["bam" bambara []]
    ["ban" balinese []]
    ["bas" basa []]
    ["bat" baltic []]
    ["bej" beja []]
    ["bel" belarusian []]
    ["bem" bemba []]
    ["ben" bengali []]
    ["ber" berber []]
    ["bho" bhojpuri []]
    ["bih" bihari []]
    ["bik" bikol []]
    ["bin" edo []]
    ["bis" bislama []]
    ["bla" siksika []]
    ["bnt" bantu []]
    ["bod" tibetan []]
    ["bos" bosnian []]
    ["bra" braj []]
    ["bre" breton []]
    ["btk" batak []]
    ["bua" buriat []]
    ["bug" buginese []]
    ["bul" bulgarian []]
    ["byn" blin []]
    ["cad" caddo []]
    ["cai" central-american-indian []]
    ["car" galibi-carib []]
    ["cat" catalan [[valencian]]]
    ["cau" caucasian []]
    ["ceb" cebuano []]
    ["cel" celtic []]
    ["ces" czech []]
    ["cha" chamorro []]
    ["chb" chibcha []]
    ["che" chechen []]
    ["chg" chagatai []]
    ["chk" chuukese []]
    ["chm" mari []]
    ["chn" chinook []]
    ["cho" choctaw []]
    ["chp" chipewyan []]
    ["chr" cherokee []]
    ["chu" church-slavic [[old-slavonic] [church-slavonic] [old-bulgarian] [old-church-slavonic]]]
    ["chv" chuvash []]
    ["chy" cheyenne []]
    ["cmc" chamic []]
    ["cnr" montenegrin []]
    ["cop" coptic []]
    ["cor" cornish []]
    ["cos" corsican []]
    ["cpe" creoles-and-pidgins/english []]
    ["cpf" creoles-and-pidgins/french []]
    ["cpp" creoles-and-pidgins/portuguese []]
    ["cre" cree []]
    ["crh" crimean []]
    ["crp" creoles-and-pidgins []]
    ["csb" kashubian []]
    ["cus" cushitic []]
    ["cym" welsh []]
    ["dak" dakota []]
    ["dan" danish []]
    ["dar" dargwa []]
    ["day" land-dayak []]
    ["del" delaware []]
    ["den" slavey []]
    ["dgr" dogrib []]
    ["din" dinka []]
    ["div" dhivehi [[maldivian]]]
    ["doi" dogri []]
    ["dra" dravidian []]
    ["dsb" lower-sorbian []]
    ["dua" duala []]
    ["dum" middle-dutch []]
    ["dyu" dyula []]
    ["dzo" dzongkha []]
    ["efi" efik []]
    ["egy" egyptian []]
    ["eka" ekajuk []]
    ["ell" greek []]
    ["elx" elamite []]
    ["eng" english []]
    ["enm" middle-english []]
    ["epo" esperanto []]
    ["est" estonian []]
    ["eus" basque []]
    ["ewe" ewe []]
    ["ewo" ewondo []]
    ["fan" fang []]
    ["fao" faroese []]
    ["fas" persian []]
    ["fat" fanti []]
    ["fij" fijian []]
    ["fil" filipino []]
    ["fin" finnish []]
    ["fiu" finno-ugrian []]
    ["fon" fon []]
    ["fra" French []]
    ["frm" middle-french []]
    ["fro" old-french []]
    ["frr" northern-frisian []]
    ["frs" eastern-frisian []]
    ["fry" western-frisian []]
    ["ful" fulah []]
    ["fur" friulian []]
    ["gaa" ga []]
    ["gay" gayo []]
    ["gba" gbaya []]
    ["gem" germanic []]
    ["deu" german []]
    ["gez" geez []]
    ["gil" gilbertese []]
    ["gla" gaelic []]
    ["gle" irish []]
    ["glg" galician []]
    ["glv" manx []]
    ["gmh" middle-high-german []]
    ["goh" old-high-german []]
    ["gon" gondi []]
    ["gor" gorontalo []]
    ["got" gothic []]
    ["grb" grebo []]
    ["grc" ancient-greek []]
    ["grn" guarani []]
    ["gsw" swiss-german [[alemannic] [alsatian]]]
    ["guj" gujarati []]
    ["gwi" gwich'in []]
    ["hai" haida []]
    ["hat" haitian []]
    ["hau" hausa []]
    ["haw" hawaiian []]
    ["heb" hebrew []]
    ["her" herero []]
    ["hil" hiligaynon []]
    ["him" himachali []]
    ["hin" hindi []]
    ["hit" hittite []]
    ["hmn" hmong []]
    ["hmo" hiri-motu []]
    ["hrv" croatian []]
    ["hsb" upper-sorbian []]
    ["hun" hungarian []]
    ["hup" hupa []]
    ["hye" armenian []]
    ["iba" iban []]
    ["ibo" igbo []]
    ["ido" ido []]
    ["iii" sichuan-yi [[nuosu]]]
    ["ijo" ijo []]
    ["iku" inuktitut []]
    ["ile" interlingue []]
    ["ilo" iloko []]
    ["ina" interlingua []]
    ["inc" indic []]
    ["ind" indonesian []]
    ["ine" indo-european []]
    ["inh" ingush []]
    ["ipk" inupiaq []]
    ["ira" iranian []]
    ["iro" iroquoian []]
    ["isl" icelandic []]
    ["ita" italian []]
    ["jav" javanese []]
    ["jbo" lojban []]
    ["jpn" japanese []]
    ["jpr" judeo-persian []]
    ["jrb" judeo-arabic []]
    ["kaa" kara-kalpak []]
    ["kab" kabyle []]
    ["kac" kachin [[jingpho]]]
    ["kal" kalaallisut [[greenlandic]]]
    ["kam" kamba []]
    ["kan" kannada []]
    ["kar" karen []]
    ["kas" kashmiri []]
    ["kat" georgian []]
    ["kau" kanuri []]
    ["kaw" kawi []]
    ["kaz" kazakh []]
    ["kbd" kabardian []]
    ["kha" khasi []]
    ["khi" khoisan []]
    ["khm" central-khmer []]
    ["kho" khotanese [[sakan]]]
    ["kik" gikuyu []]
    ["kin" kinyarwanda []]
    ["kir" kyrgyz []]
    ["kmb" kimbundu []]
    ["kok" konkani []]
    ["kom" komi []]
    ["kon" kongo []]
    ["kor" korean []]
    ["kos" kosraean []]
    ["kpe" kpelle []]
    ["krc" karachay-balkar []]
    ["krl" karelian []]
    ["kro" kru []]
    ["kru" kurukh []]
    ["kua" kwanyama []]
    ["kum" kumyk []]
    ["kur" kurdish []]
    ["kut" kutenai []]
    ["lad" ladino []]
    ["lah" lahnda []]
    ["lam" lamba []]
    ["lao" lao []]
    ["lat" latin []]
    ["lav" latvian []]
    ["lez" lezghian []]
    ["lim" limburgan []]
    ["lin" lingala []]
    ["lit" lithuanian []]
    ["lol" mongo []]
    ["loz" lozi []]
    ["ltz" luxembourgish []]
    ["lua" luba-lulua []]
    ["lub" luba-katanga []]
    ["lug" ganda []]
    ["lui" luiseno []]
    ["lun" lunda []]
    ["luo" luo []]
    ["lus" lushai []]
    ["mad" madurese []]
    ["mag" magahi []]
    ["mah" marshallese []]
    ["mai" maithili []]
    ["mak" makasar []]
    ["mal" malayalam []]
    ["man" mandingo []]
    ["map" austronesian []]
    ["mar" marathi []]
    ["mas" masai []]
    ["mdf" moksha []]
    ["mdr" mandar []]
    ["men" mende []]
    ["mga" middle-irish []]
    ["mic" mi'kmaq [[micmac]]]
    ["min" minangkabau []]
    ["mkd" macedonian []]
    ["mkh" mon-khmer []]
    ["mlg" malagasy []]
    ["mlt" maltese []]
    ["mnc" manchu []]
    ["mni" manipuri []]
    ["mno" manobo []]
    ["moh" mohawk []]
    ["mon" mongolian []]
    ["mos" mossi []]
    ["mri" maori []]
    ["msa" malay []]
    ["mun" munda []]
    ["mus" creek []]
    ["mwl" mirandese []]
    ["mwr" marwari []]
    ["mya" burmese []]
    ["myn" mayan []]
    ["myv" erzya []]
    ["nah" nahuatl []]
    ["nai" north-american-indian []]
    ["nap" neapolitan []]
    ["nau" nauru []]
    ["nav" navajo []]
    ["nbl" south-ndebele []]
    ["nde" north-ndebele []]
    ["ndo" ndonga []]
    ["nds" low-german []]
    ["nep" nepali []]
    ["new" newari [[nepal-bhasa]]]
    ["nia" nias []]
    ["nic" niger-kordofanian []]
    ["niu" niuean []]
    ["nld" dutch [[flemish]]]
    ["nno" nynorsk []]
    ["nob" bokmal []]
    ["nog" nogai []]
    ["non" old-norse []]
    ["nor" norwegian []]
    ["nqo" n'ko []]
    ["nso" northern-sotho [[pedi] [sepedi]]]
    ["nub" nubian []]
    ["nwc" old-newari [[classical-newari] [classical-nepal-bhasa]]]
    ["nya" nyanja [[chichewa] [chewa]]]
    ["nym" nyamwezi []]
    ["nyn" nyankole []]
    ["nyo" nyoro []]
    ["nzi" nzima []]
    ["oci" occitan [[provencal]]]
    ["oji" ojibwa []]
    ["ori" oriya []]
    ["orm" oromo []]
    ["osa" osage []]
    ["oss" ossetic []]
    ["ota" ottoman-turkish []]
    ["oto" otomian []]
    ["paa" papuan []]
    ["pag" pangasinan []]
    ["pal" pahlavi []]
    ["pam" pampanga [[kapampangan]]]
    ["pan" punjabi []]
    ["pap" papiamento []]
    ["pau" palauan []]
    ["peo" old-persian []]
    ["phi" philippine []]
    ["phn" phoenician []]
    ["pli" pali []]
    ["pol" polish []]
    ["pon" pohnpeian []]
    ["por" portuguese []]
    ["pra" prakrit []]
    ["pro" old-provencal []]
    ["pus" pashto []]
    ["que" quechua []]
    ["raj" rajasthani []]
    ["rap" rapanui []]
    ["rar" rarotongan [[cook-islands-maori]]]
    ["roa" romance []]
    ["roh" romansh []]
    ["rom" romany []]
    ["ron" romanian [[moldavian] [moldovan]]]
    ["run" rundi []]
    ["rup" aromanian [[arumanian] [macedo-romanian]]]
    ["rus" russian []]
    ["sad" sandawe []]
    ["sag" sango []]
    ["sah" yakut []]
    ["sai" south-american-indian []]
    ["sal" salishan []]
    ["sam" samaritan-aramaic []]
    ["san" sanskrit []]
    ["sas" sasak []]
    ["sat" santali []]
    ["scn" sicilian []]
    ["sco" scots []]
    ["sel" selkup []]
    ["sem" semitic []]
    ["sga" old-irish []]
    ["sgn" sign []]
    ["shn" shan []]
    ["sid" sidamo []]
    ["sin" sinhalese []]
    ["sio" siouan []]
    ["sit" sino-tibetan []]
    ["sla" slavic []]
    ["slk" slovak []]
    ["slv" slovenian []]
    ["sma" southern-sami []]
    ["sme" northern-sami []]
    ["smi" sami []]
    ["smj" lule []]
    ["smn" inari []]
    ["smo" samoan []]
    ["sms" skolt-sami []]
    ["sna" shona []]
    ["snd" sindhi []]
    ["snk" soninke []]
    ["sog" sogdian []]
    ["som" somali []]
    ["son" songhai []]
    ["sot" southern-sotho []]
    ["spa" spanish [[castilian]]]
    ["sqi" albanian []]
    ["srd" sardinian []]
    ["srn" sranan-tongo []]
    ["srp" serbian []]
    ["srr" serer []]
    ["ssa" nilo-saharan []]
    ["ssw" swati []]
    ["suk" sukuma []]
    ["sun" sundanese []]
    ["sus" susu []]
    ["sux" sumerian []]
    ["swa" swahili []]
    ["swe" swedish []]
    ["syc" classical-syriac []]
    ["syr" syriac []]
    ["tah" tahitian []]
    ["tai" tai []]
    ["tam" tamil []]
    ["tat" tatar []]
    ["tel" telugu []]
    ["tem" timne []]
    ["ter" tereno []]
    ["tet" tetum []]
    ["tgk" tajik []]
    ["tgl" tagalog []]
    ["tha" thai []]
    ["tig" tigre []]
    ["tir" tigrinya []]
    ["tiv" tiv []]
    ["tkl" tokelau []]
    ["tlh" klingon []]
    ["tli" tlingit []]
    ["tmh" tamashek []]
    ["tog" tonga []]
    ["ton" tongan []]
    ["tpi" tok-pisin []]
    ["tsi" tsimshian []]
    ["tsn" tswana []]
    ["tso" tsonga []]
    ["tuk" turkmen []]
    ["tum" tumbuka []]
    ["tup" tupi []]
    ["tur" turkish []]
    ["tut" altaic []]
    ["tvl" tuvalu []]
    ["twi" twi []]
    ["tyv" tuvinian []]
    ["udm" udmurt []]
    ["uga" ugaritic []]
    ["uig" uyghur []]
    ["ukr" ukrainian []]
    ["umb" umbundu []]
    ["urd" urdu []]
    ["uzb" uzbek []]
    ["vai" vai []]
    ["ven" venda []]
    ["vie" vietnamese []]
    ["vol" volap√ºk []]
    ["vot" votic []]
    ["wak" wakashan []]
    ["wal" walamo []]
    ["war" waray []]
    ["was" washo []]
    ["wen" sorbian []]
    ["wln" walloon []]
    ["wol" wolof []]
    ["xal" kalmyk [[oirat]]]
    ["xho" xhosa []]
    ["yao" yao []]
    ["yap" yapese []]
    ["yid" yiddish []]
    ["yor" yoruba []]
    ["ypk" yupik []]
    ["zap" zapotec []]
    ["zbl" blissymbols []]
    ["zen" zenaga []]
    ["zgh" standard-moroccan-tamazight []]
    ["zha" zhuang []]
    ["zho" chinese []]
    ["znd" zande []]
    ["zul" zulu []]
    ["zun" zuni []]
    ["zza" zaza [[dimili] [dimli] [kirdki] [kirmanjki] [zazaki]]]
    )

  (structure: #export _ (Equivalence Language)
    (def: (= reference sample)
      (is? reference sample)))

  (structure: #export _ (Hash Language)
    (def: eq Equivalence<Language>)
    
    (def: hash
      (|>> :representation
           (:: text.Hash<Text> hash))))
  )
