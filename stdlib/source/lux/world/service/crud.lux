(.module:
  [lux #*
   [control
    [security
     ["!" capability (#+ capability:)]]]
   [data
    ["." error (#+ Error)]]
   [time
    ["." instant (#+ Instant)]]])

(type: #export ID Nat)

(type: #export Time
  {#created Instant
   #updated Instant})

(capability: #export (Can-Create ! entity)
  (can-create [Instant entity] (! (Error ID))))

(capability: #export (Can-Retrieve ! entity)
  (can-retrieve ID (! (Error [Time entity]))))

(capability: #export (Can-Update ! entity)
  (can-update [ID Instant entity] (! (Error Any))))

(capability: #export (Can-Delete ! entity)
  (can-delete ID (! (Error Any))))

(type: #export (CRUD ! entity)
  {#can-create (Can-Create ! entity)
   #can-retrieve (Can-Retrieve ! entity)
   #can-update (Can-Update ! entity)
   #can-delete (Can-Delete ! entity)})
