(.module:
  [lux (#- int char)
   [data
    [text
     ["%" format (#+ format)]]]
   [type
    abstract]]
  ["." //
   [category (#+ Void Value Return Method Primitive Object Class Array Parameter)]
   ["#." descriptor]
   [//
    [encoding
     ["#." name (#+ External)]]]])

(abstract: #export (Reflection brand)
  {}

  Text

  (def: #export reflection
    (-> (Reflection Any) Text)
    (|>> :representation))

  (template [<brand> <name> <reflection>]
    [(def: #export <name>
       (Reflection <brand>)
       (:abstraction <reflection>))]

    [Void void "void"]
    [Primitive boolean "boolean"]
    [Primitive byte "byte"]
    [Primitive short "short"]
    [Primitive int "int"]
    [Primitive long "long"]
    [Primitive float "float"]
    [Primitive double "double"]
    [Primitive char "char"]
    )

  (def: #export class
    (-> External (Reflection Class))
    (|>> :abstraction))

  (def: #export array
    (-> (Reflection Class) (Reflection Array))
    (|>> :representation
         (format //descriptor.array-prefix)
         :abstraction))

  (template [<name>]
    [(def: #export <name>
       (Reflection Parameter)
       (:transmutation
        (..class "java.lang.Object")))]

    [var]
    [wildcard]
    )

  (def: #export (lower descriptor)
    (-> (Descriptor Class) (Descriptor Parameter))
    ..wildcard)

  (def: #export upper
    (-> (Descriptor Class) (Descriptor Parameter))
    (|>> :transmutation))
  )
