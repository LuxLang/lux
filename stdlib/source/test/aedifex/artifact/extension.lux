(.using
 [library
  [lux "*"
   ["_" test {"+" Test}]
   [abstract
    [monad {"+" do}]]
   [data
    ["[0]" text ("[1]#[0]" equivalence)]
    [collection
     ["[0]" set]
     ["[0]" list]]]
   [math
    ["[0]" random {"+" Random}]
    [number
     ["n" nat]]]]]
 [\\program
  ["[0]" /
   ["/[1]" // "_"
    ["[1]" type]]]])

(def: .public test
  Test
  (<| (_.covering /._)
      (_.for [/.Extension]
             (all _.and
                  (_.cover [/.lux_library /.jvm_library /.pom
                            /.sha-1 /.md5]
                           (let [options (list /.lux_library /.jvm_library /.pom /.sha-1 /.md5)
                                 uniques (set.of_list text.hash options)]
                             (n.= (list.size options)
                                  (set.size uniques))))
                  (_.cover [/.extension /.type]
                           (`` (and (~~ (template [<type> <extension>]
                                          [(and (text#= <extension>
                                                        (/.extension <type>))
                                                (text#= <type>
                                                        (/.type (/.extension <type>))))]

                                          [//.lux_library /.lux_library]
                                          [//.jvm_library /.jvm_library]
                                          [//.pom /.pom]
                                          )))))
                  ))))
