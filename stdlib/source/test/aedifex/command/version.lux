(.module:
  [lux #*
   ["_" test (#+ Test)]
   [abstract
    [monad (#+ do)]]
   [control
    ["." try]
    [concurrency
     ["." promise]]]
   [math
    ["." random]]]
  [///
   ["@." profile]]
  {#program
   ["." /]})

(def: #export test
  Test
  (<| (_.covering /._)
      (do random.monad
        [profile @profile.random]
        (wrap (do promise.monad
                [verdict (do (try.with promise.monad)
                           [_ (/.do! profile)]
                           (wrap true))]
                (_.cover' [/.do!]
                          (try.default false verdict)))))))
