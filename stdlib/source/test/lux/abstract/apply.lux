(.module:
  [library
   [lux #*
    [abstract
     [monad (#+ do)]]
    [control
     ["." maybe]]
    [data
     [collection
      ["." list]]]
    [math
     ["." random]
     [number
      ["n" nat]]]
    ["_" test (#+ Test)]]]
  [\\library
   ["." / (#+ Apply)]])

(def: .public test
  Test
  (do random.monad
    [left random.nat
     right random.nat]
    (<| (_.covering /._)
        ($_ _.and
            (_.cover [/.composite]
                     (let [expected (n.+ left right)]
                       (case (\ (/.composite maybe.monad maybe.apply list.apply) on
                                (#.Some (list right))
                                (#.Some (list (n.+ left))))
                         (^ (#.Some (list actual)))
                         (n.= expected actual)

                         _
                         false)))
            ))))
