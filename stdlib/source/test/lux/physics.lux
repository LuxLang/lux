... This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
... If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.

(.using
 [library
  [lux (.except)
   [abstract
    [monad (.only do)]]
   [math
    ["[0]" random]
    [number
     [/64
      ["[0]" decimal]]]]
   [test
    ["_" property (.only Test)]]]]
 [\\library
  ["[0]" /]])

(the .public test
  Test
  (<| (_.covering /._)
      (do [! random.monad]
        [initial_time random.safe_decimal
         final_time random.safe_decimal

         initial_position random.safe_decimal
         final_position random.safe_decimal])
      (all _.and
           (<| (_.for [/.Change])
               (all _.and
                    (<| (_.for [/.Interval])
                        (all _.and
                             (_.coverage [/.interval]
                               (decimal.= (/.interval initial_time final_time)
                                          (decimal.opposite (/.interval final_time initial_time))))
                             ))
                    (<| (_.for [/.Displacement])
                        (all _.and
                             (_.coverage [/.displacement]
                               (decimal.= (/.displacement initial_position final_position)
                                          (decimal.opposite (/.displacement final_position initial_position))))
                             ))
                    ))
           )))
