(.require
 [library
  [lux (.except)
   ["$" documentation]
   [data
    ["[0]" text (.only \n)
     ["%" \\format (.only format)]]]]]
 ["[0]" \\parser]
 [\\library
  ["[0]" /]])

(.def \\parser
  (.List $.Module)
  ($.module \\parser._
            ""
            [($.default \\parser.unknown_property)

             ($.documentation \\parser.Property
               "A property in the environment.")

             ($.documentation \\parser.Environment
               "An abstraction for environment variables of a program.")

             ($.documentation (\\parser.Parser it)
               "A parser of environment variables of a program.")

             ($.documentation \\parser.empty
               "An empty environment.")

             ($.documentation \\parser.property
               ""
               [(property name)])

             ($.documentation \\parser.result
               (format "Executes a parser against the given environment variables."
                       \n "Does not check whether all environment variables were parsed, since they're usually an open set.")
               [(result parser environment)])]
            []))

(.def .public documentation
  (.List $.Module)
  ($.module /._
            ""
            [($.default /.unknown_environment_variable)
             ($.default /.async)
             ($.default /.default)

             ($.documentation (/.Environment !)
               "Access to ambient environment data and the capacity to exit the program.")

             ($.documentation /.environment
               "Assembles the environment variables available to the program."
               [(environment monad program)])

             ($.documentation /.mock
               ""
               [(mock environment home directory)])]
            [..\\parser]))
