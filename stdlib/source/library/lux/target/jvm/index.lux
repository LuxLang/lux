(.module:
  [library
   [lux "*"
    [abstract
     ["[0]" equivalence {"+" [Equivalence]}]]
    [data
     [format
      [binary {"+" [Writer]}]]]
    [type
     abstract]]]
  ["[0]" // "_"
   [encoding
    ["[1][0]" unsigned {"+" [U2]}]]])

(def: .public length
  //unsigned.bytes/2)

(abstract: .public (Index kind)
  U2

  (def: .public index
    (All (_ kind) (-> U2 (Index kind)))
    (|>> :abstraction))

  (def: .public value
    (-> (Index Any) U2)
    (|>> :representation))

  (def: .public equivalence
    (All (_ kind) (Equivalence (Index kind)))
    (\ equivalence.functor each
       ..value
       //unsigned.equivalence))

  (def: .public writer
    (All (_ kind) (Writer (Index kind)))
    (|>> :representation //unsigned.writer/2))
  )
