... This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
... If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.

(.using
 [library
  [lux (.except text natural)
   [abstract
    [monad (.only do)]
    ["<>" projection]]
   [control
    ["[0]" maybe]]
   [data
    [collection
     ["[0]" list
      ["?[1]" \\projection]]]]
   [math
    ["[0]" random (.only Random) (.use "[1]#[0]" functor)]]]]
 [//
  ["//" natural]
  [//
   [/64
    ["/" fraction]]]])

(/.module //.Number //.small
          //.= //.< //.greatest_common_divisor
          //.zero //.one
          //.+ //.- //.x //./ //.%
          /.delimiter //.base_10)

(the .public (random digits)
  (-> Natural
      (Random ..Number))
  (let [part (//.random digits)]
    (do random.monad
      [numerator part
       denominator part]
      (pure (new denominator numerator)))))
