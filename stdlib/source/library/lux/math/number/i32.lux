(.require
 [library
  [lux (.except i64)
   [abstract
    [equivalence (.only Equivalence)]]
   [control
    ["?" parser]
    ["[0]" maybe]
    ["[0]" try]]
   [meta
    ["[0]" static]
    ["[0]" type (.only)
     ["?[1]" \\parser]]]]]
 [//
  ["[0]" i64]])

(def sub
  (maybe.trusted (i64.sub 32)))

(`` (type .public I32
      (I64 (,, (|> (type_of ..sub)
                   (?type.result (?type.applied (?.after (?type.exactly i64.Sub)
                                                         ?type.any)))
                   try.trusted
                   (static.literal type.code))))))

(def .public equivalence (Equivalence I32) (at ..sub sub_equivalence))
(def .public width Nat (at ..sub bits))
(def .public i32 (-> I64 I32) (at ..sub narrow))
(def .public i64 (-> I32 I64) (at ..sub wide))
