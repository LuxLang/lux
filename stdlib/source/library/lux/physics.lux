... This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
... If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.

... https://en.wikipedia.org/wiki/Physics
(.using
 [library
  [lux (.except Change)
   [math
    [number
     [/64
      ["/" decimal]]]]]])

... https://en.wikipedia.org/wiki/Scalar_(physics)
(every .public Scalar
  Decimal)

(every .public Dimension
  Scalar)

... https://en.wikipedia.org/wiki/Time
(every .public Time
  Dimension)

(every .public (Constant dimension)
  dimension)

(every .public (Variable dimension)
  (-> Time
      (Constant dimension)))

... https://en.wikipedia.org/wiki/Position_(geometry)
(every .public Position
  Dimension)

(every .public (Change it)
  it)

(every .public Interval
  (Change Time))

(the .public (interval initial final)
  (-> Time Time
      Interval)
  (/.- initial final))

... https://en.wikipedia.org/wiki/Displacement_(geometry)
(every .public Displacement
  (Change Position))

(the .public (displacement initial final)
  (-> Position Position
      Displacement)
  (/.- initial final))

... https://en.wikipedia.org/wiki/Velocity
(every .public Velocity
  Scalar)

(the .public (average_velocity interval displacement)
  (-> Interval Displacement
      Velocity)
  (/./ interval displacement))

... https://en.wikipedia.org/wiki/Acceleration
(every .public Acceleration
  Scalar)

(the .public (average_acceleration interval change_in_velocity)
  (-> Interval (Change Velocity)
      Acceleration)
  (/./ interval change_in_velocity))

(the .public (velocity acceleration initial)
  (-> Acceleration Velocity
      (Variable Velocity))
  (|>> (/.x acceleration)
       (/.+ initial)))

(the (mean left right)
  (-> Scalar Scalar
      Scalar)
  (/./ +2.0
       (/.+ left right)))

(the .public (position acceleration initial_velocity initial)
  (-> Acceleration Velocity Position
      (Variable Position))
  (function (_ time)
    (let [velocity (mean initial_velocity
                         (..velocity acceleration initial_velocity time))]
      (|> time
          (/.x velocity)
          (/.+ initial)))))
