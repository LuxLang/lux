... This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
... If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.

(.require
 [library
  [lux (.except)]]
 [//
  ["[0]" input]
  ["[0]" output]])

(every .public (Match negative positive value)
  (-> negative positive
      value))

(every .public Constant
  (All (_ value)
    (Match (output.One value) input.Zero
           value)))

(the .public constant
  Constant
  (function (_ one (input.zero))
    one))

(every .public (Natural negative_change positive_change)
  (All (_ value negative positive)
    (-> (Match negative positive
               value)
        (Match (negative_change negative) (positive_change positive)
               value))))

(every .public Zero
  (Natural output.One input.One))

(the .public zero
  Zero
  (|>>))

(every .public (Succ of)
  (Natural (output.Succ of) (input.Succ of)))

(the .public (succ pred)
  Succ
  (function (_ negative (input.succ ++ --))
    (pred (negative ++) --)))
