(.module:
  [library
   [lux #*
    [abstract
     [monoid (#+ Monoid)]]]])

(def: .public identity
  (All [a] (-> a a))
  (|>>))

(def: .public (composite f g)
  (All [a b c]
    (-> (-> b c) (-> a b) (-> a c)))
  (|>> g f))

(def: .public (constant value)
  (All [o] (-> o (All [i] (-> i o))))
  (function (_ _) value))

(def: .public (flipped f)
  (All [a b c]
    (-> (-> a b c) (-> b a c)))
  (function (_ x y) (f y x)))

(def: .public (on input function)
  (All [i o]
    (-> i (-> i o) o))
  (function input))

(implementation: .public monoid
  (All [a] (Monoid (-> a a)))
  
  (def: identity ..identity)
  (def: composite ..composite))
