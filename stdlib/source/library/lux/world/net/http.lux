(.module:
  [library
   [lux #*
    [control
     [try (#+ Try)]
     [concurrency
      [frp (#+ Channel)]]
     [parser
      ["." environment (#+ Environment)]]]
    [data
     [binary (#+ Binary)]]]]
  [// (#+ URL)
   [uri (#+ URI)]])

(type: .public Version
  Text)

(type: .public Method
  #Post
  #Get
  #Put
  #Patch
  #Delete
  #Head
  #Connect
  #Options
  #Trace)

(type: .public Port
  Nat)

(type: .public Status
  Nat)

(type: .public Headers
  Environment)

(def: .public empty
  Headers
  environment.empty)

(type: .public Header
  (-> Headers Headers))

(type: .public (Body !)
  (-> (Maybe Nat) (! (Try [Nat Binary]))))

(type: .public Scheme
  #HTTP
  #HTTPS)

(type: .public Address
  {#port Port
   #host Text})

(type: .public Identification
  {#local  Address
   #remote Address})

(type: .public Protocol
  {#version Version
   #scheme  Scheme})

(type: .public Resource
  {#method Method
   #uri    URI})

(type: .public (Message !)
  {#headers Headers
   #body    (Body !)})

(type: .public (Request !)
  [Identification Protocol Resource (Message !)])

(type: .public (Response !)
  [Status (Message !)])

(type: .public (Server !)
  (-> (Request !) (! (Response !))))
