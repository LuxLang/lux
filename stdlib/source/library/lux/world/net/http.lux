(.require
 [library
  [lux (.except #version #host)
   [control
    [try (.only Try)]
    [concurrency
     [frp (.only Channel)]]]
   [data
    [binary (.only Binary)]]]]
 [/
  [version (.only Version)]
  [status (.only Status)]
  [header (.only Headers)]]
 [// (.only Address)
  [uri (.only URI)
   [scheme (.only Scheme)]]])

(type .public Method
  (Variant
   {#Post}
   {#Get}
   {#Put}
   {#Patch}
   {#Delete}
   {#Head}
   {#Connect}
   {#Options}
   {#Trace}))

(type .public (Body !)
  (-> (Maybe Nat)
      (! (Try [Nat Binary]))))

(type .public Identification
  (Record
   [#local Address
    #remote Address]))

(type .public Protocol
  (Record
   [#version Version
    #scheme Scheme]))

(type .public Resource
  (Record
   [#method Method
    #uri URI]))

(type .public (Message !)
  (Record
   [#headers Headers
    #body (Body !)]))
