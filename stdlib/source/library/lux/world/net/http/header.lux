(.module:
  [library
   [lux "*"
    [control
     [pipe {"+" [case>]}]]
    [data
     [text
      ["%" format {"+" [format]}]]
     [collection
      ["." dictionary {"+" [Dictionary]}]]]]]
  [// {"+" [Header]}
   ["." mime {"+" [MIME]}]
   [// {"+" [URL]}]])

(def: .public (has name value)
  (-> Text Text Header)
  (dictionary.revised' name ""
                       (|>> (case>
                             ""
                             value
                             
                             previous
                             (format previous "," value)))))

(def: .public content_length
  (-> Nat Header)
  (|>> %.nat (..has "Content-Length")))

(def: .public content_type
  (-> MIME Header)
  (|>> mime.name (..has "Content-Type")))

(def: .public location
  (-> URL Header)
  (..has "Location"))
