(.require
 [library
  [lux (.except)
   [control
    ["[0]" pipe]]
   [data
    [text
     ["%" \\format (.only format)]]
    [collection
     ["[0]" dictionary (.only Dictionary)]]]]]
 [// (.only Header)
  ["[0]" mime (.only MIME)]
  [// (.only URL)]])

(def .public (has name value)
  (-> Text Text Header)
  (dictionary.revised' name ""
                       (|>> (pipe.when
                              ""
                              value
                              
                              previous
                              (format previous "," value)))))

(def .public content_length
  (-> Nat Header)
  (|>> %.nat (..has "Content-Length")))

(def .public content_type
  (-> MIME Header)
  (|>> mime.name (..has "Content-Type")))

(def .public location
  (-> URL Header)
  (..has "Location"))
