(.module:
  [library
   [lux #*
    [control
     ["." try (#+ Try)]
     [security
      ["!" capability (#+ capability:)]]]
    [time
     ["." instant (#+ Instant)]]]])

(type: #export ID Nat)

(type: #export Time
  {#created Instant
   #updated Instant})

(capability: #export (Can_Create ! entity)
  (can_create [Instant entity] (! (Try ID))))

(capability: #export (Can_Retrieve ! entity)
  (can_retrieve ID (! (Try [Time entity]))))

(capability: #export (Can_Update ! entity)
  (can_update [ID Instant entity] (! (Try Any))))

(capability: #export (Can_Delete ! entity)
  (can_delete ID (! (Try Any))))

(type: #export (CRUD ! entity)
  {#can_create (Can_Create ! entity)
   #can_retrieve (Can_Retrieve ! entity)
   #can_update (Can_Update ! entity)
   #can_delete (Can_Delete ! entity)})
