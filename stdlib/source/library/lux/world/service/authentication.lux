(.module:
  [library
   [lux #*
    [control
     [try (#+ Try)]
     [security
      [capability (#+ Capability)]]]]])

(type: #export (Can_Register ! account secret value)
  (Capability [account secret value] (! (Try Any))))

(type: #export (Can_Authenticate ! account secret value)
  (Capability [account secret] (! (Try value))))

(type: #export (Can_Reset ! account secret)
  (Capability [account secret] (! (Try Any))))

(type: #export (Can_Forget ! account)
  (Capability [account] (! (Try Any))))

(type: #export (Service ! account secret value)
  {#can_register (Can_Register ! account secret value)
   #can_authenticate (Can_Authenticate ! account secret value)
   #can_reset (Can_Reset ! account secret)
   #can_forget (Can_Forget ! account)})
