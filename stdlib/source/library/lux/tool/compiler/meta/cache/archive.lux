(.using
 [library
  [lux "*"
   [control
    [try {"+" Try}]]
   [data
    [text
     ["%" format]]]
   [world
    ["[0]" file]]]]
 ["[0]" //
  ["/[1]" //
   [context {"+" Context}]
   ["[0]" archive {"+" Archive}]]])

(def: .public (descriptor fs context)
  (All (_ !) (-> (file.System !) Context file.Path))
  (%.format (//.path fs context)
            (# fs separator)
            "descriptor"))

(def: .public (cache! fs context it)
  (All (_ !) (-> (file.System !) Context Archive (! (Try Any))))
  (# fs write (..descriptor fs context) (archive.export ///.version it)))
