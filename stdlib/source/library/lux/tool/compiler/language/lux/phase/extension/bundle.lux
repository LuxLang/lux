(.using
 [library
  [lux (.full)
   [abstract
    [monad (.only do)]]
   [data
    ["[0]" text
     ["%" format (.only format)]]
    [collection
     ["[0]" list ("[1]#[0]" functor)]
     ["[0]" dictionary (.only Dictionary)]]]]]
 [// (.only Handler Bundle)])

(def: .public empty
  Bundle
  (dictionary.empty text.hash))

(def: .public (install name anonymous)
  (All (_ s i o)
    (-> Text (Handler s i o)
        (-> (Bundle s i o) (Bundle s i o))))
  (dictionary.has name anonymous))

(def: .public (prefix prefix)
  (All (_ s i o)
    (-> Text (-> (Bundle s i o) (Bundle s i o))))
  (|>> dictionary.entries
       (list#each (function (_ [key val]) [(format prefix " " key) val]))
       (dictionary.of_list text.hash)))
