(.module:
  [lux #*
   [abstract
    [monad (#+ do)]]
   [control
    ["<>" parser
     ["<.>" text (#+ Parser)]]]
   [data
    [text
     ["%" format]]]
   [time
    ["." instant (#+ Instant)]]]
  ["." / #_
   ["#." date]
   ["#." time]])

(type: #export Time_Stamp
  Instant)

(def: #export separator
  ".")

(def: #export (format value)
  (%.Format Time_Stamp)
  (%.format (/date.format (instant.date value))
            ..separator
            (/time.format (instant.time value))))

(def: #export parser
  (Parser Time_Stamp)
  (do <>.monad
    [date /date.parser
     _ (<text>.this ..separator)
     time /time.parser]
    (wrap (instant.from_date_time date time))))
