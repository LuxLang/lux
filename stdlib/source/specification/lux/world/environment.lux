(.require
 [library
  [lux (.except)
   [abstract
    [monad (.only do)]]
   [control
    ["[0]" try]
    [concurrency
     ["[0]" async (.only Async)]]]
   [data
    ["[0]" text]
    [collection
     ["[0]" dictionary]
     ["[0]" list]]]
   [math
    ["[0]" random]]
   [test
    ["_" property (.only Test)]
    ["[0]" unit]]]]
 [\\library
  ["[0]" /]])

(def .public (spec subject)
  (-> (/.Environment Async) Test)
  (do random.monad
    [exit random.int]
    (in (do [! async.monad]
          [environment (/.environment ! subject)]
          (unit.coverage [/.Environment]
            (and (not (dictionary.empty? environment))
                 (list.every? (|>> text.empty? not)
                              (dictionary.keys environment))
                 (not (text.empty? (at subject home)))
                 (not (text.empty? (at subject directory)))))))))
