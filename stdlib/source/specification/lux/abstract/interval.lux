(.module:
  [library
   [lux "*"
    ["_" test {"+" [Test]}]
    [abstract
     [monad {"+" [do]}]
     ["." order]]
    [math
     ["." random {"+" [Random]}]]]]
  [\\library
   ["." /]])

(def: .public (spec (^open "@//.") gen_sample)
  (All (_ a) (-> (/.Interval a) (Random a) Test))
  (<| (_.for [/.Interval])
      (do random.monad
        [sample gen_sample]
        ($_ _.and
            (_.test "No value is bigger than the top."
                    (@//< @//top sample))
            (_.test "No value is smaller than the bottom."
                    (order.> @//&order @//bottom sample))
            ))))
