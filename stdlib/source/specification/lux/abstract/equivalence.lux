(.require
 [library
  [lux (.except)
   [abstract
    [monad (.only do)]]
   [data
    ["[0]" bit (.use "[1]#[0]" equivalence)]]
   [math
    ["[0]" random (.only Random)]]
   [test
    ["_" property (.only Test)]]]]
 [\\library
  ["[0]" / (.only Equivalence)]])

(def .public (spec (open "/#[0]") random)
  (All (_ a) (-> (Equivalence a) (Random a) Test))
  (do random.monad
    [left random
     right random]
    (<| (_.for [/.Equivalence])
        (_.coverage [/.=]
          (let [reflexivity!
                (/#= left left)

                symmetry!
                (bit#= (/#= left right)
                       (/#= right left))]
            (and reflexivity!
                 symmetry!
                 ))))))
